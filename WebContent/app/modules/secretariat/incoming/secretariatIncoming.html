<style>
    
	.editor{
    display: flex;
    justify-content: center;
    margin-top: 100px;
}
.template-icon{
    margin-top: 8px;
    color: #999 !important;
    height: 47px;
}
.closebtnt:hover, .closebtn{
    background-color: transparent !important;
    border-color: transparent !important;
}
.editbtn,.editbtn:hover{
    left: 28px;
    top: 68px;
    background-color: transparent !important;
    border-color: transparent !important;
}
.viewbtn , .viewbtn:hover{
    left: 56px;
    top: 37px;
    background-color: transparent !important;
    border-color: transparent !important;
}

	input.auto-size-input {
		min-width: 100%;
		max-width: 100%;
	}

	#hidden_span {
		position: absolute;
		top: 0px;
		left: 0px;
		visibility: hidden;
		width: 10px;
		white-space: nowrap;
		overflow: hidden;
	}
</style>
<div class="panel panel-default">
	<div class="panel-body" style="border-bottom: 1px solid #ddd;">
		<div class="col-sm-12">
			<a class="btn btn-sm btn-text btn-icon"
				ng-show="true" type="button"
				ng-click="Func.onReturnClick()"><i class="flaticon-close-button"></i>بستن</a>
			<a class="btn btn-sm btn-text btn-icon"
				ng-show="Data.mode=='view'" type="button"
				ng-click="Func.onEditClick()" ng-disabled=""><i class="flaticon-pencil-on-a-notes-paper"></i>{{'EDIT'|EnToFaButton}}</a>
			<a class="btn btn-sm btn-text btn-icon"
				type="button"
				ng-click="Func.onSendClick()"
			   ng-disabled="(form.$invalid && Data.validationClicked) || Data.sendClicked || Data.letter.duplicated==true"><i class="flaticon-interface-2"></i>ارسال</a>
			<!--<a class="btn btn-sm btn-text btn-icon"-->
				<!--ng-show="Data.mode=='add'" type="button"-->
				<!--ng-click="Func.onSaveClick()"-->
				<!--ng-disabled="form.$invalid && Data.validationClicked"><i class="flaticon-technology"></i>{{'SAVE'|EnToFaButton}}</a>-->
			<a class="btn btn-sm btn-text btn-icon"
				ng-show="Data.mode=='edit'" type="button"
				ng-click="Func.onUpdateClick()"
				ng-disabled="form.$invalid && Data.validationClicked"><i class="flaticon-technology"></i>{{'UPDATE'|EnToFaButton}}</a>
			<a class="btn btn-sm btn-text btn-icon"
				ng-show="Data.mode=='edit' || Data.mode=='add'" type="button"
				ng-click="Func.onResetClick()"><i class="fa fa-refresh"></i>ریست</a>
            <a class="btn btn-sm btn-text btn-icon"
				ng-hide="Data.mode!='view' || Data.letter.receivingStyle=='KATEB' || Data.letter.receivingStyle=='ORG'"
                type="button"
				ng-click="Func.onDeleteClick()"><i class="flaticon-close-button"></i>{{'DELETE'|EnToFaButton}}</a>
            <div class="btn-group" dropdown id="backDropDown" style="margin-top: -11px;"
                 ng-show="Data.mode=='view' && (Data.letter.receivingStyle=='KATEB' || Data.letter.receivingStyle=='ORG')">
                <button id="single-button" type="button" class="btn btn-primary" dropdown-toggle style="padding: 13px 0 0;display: block;">
                    <i class="fa fa-share"></i>
                    بازگشت <i class="flaticon-arrows-3"></i>
                </button>
                <div class="dropdown-menu"
                     style="z-index: 99999; margin-top: 8px;padding: 6px; border-radius: 0px; font-family:iranyekanweb"
                     role="menu" aria-labelledby="single-button">
                    <!--<span class="text-success successMessage" ng-show="sendSucceded">با موفقیت ارسال شد.</span>-->
                    <textarea ng-model="descriptionBack" placeholder="توضیحات خود را وارد نمایید..."></textarea>
                    <button type="button" class="btn btn-primary btn-block" ng-click="Func.onSendBackDescriptionClick();" style="margin-top: 10px;font-family:iranyekanweb">
                        ارسال
                    </button>
                </div>
            </div>
			<div id="draftTemplateId" class="btn-group" dropdown ng-show="Data.mode=='add'">
				<button ng-click="Func.onSaveClick()"
						type="button"
						class="btn btn-sm btn-text btn-icon white-bg"
						ng-disabled="form.$invalid && Data.validationClicked">
					<i class="flaticon-technology"></i> ‌ذخیره
				</button>
				<button type="button"
						class="btn btn btn-sm  btn-icon white-bg  "
						style="margin-right: 4px; padding: 5px 30px;"
						dropdown-toggle>ذخیره قالب نامه

					<span class="caret"></span>
					<span class="sr-only">Split button!</span>
				</button>
				<ul class="dropdown-menu"
					role="menu"
					style="z-index: 999; margin-top: 8px; padding: 6px; font-family: iranyekanweb; border-radius: 0px;">
					<li>
						<div class="input-group">
							<input
									type="text"
									class="form-control"
									placeholder="نام قالب ..."
									ng-model="Data.userDefinedTemplateName"> 
						</div>
					</li>
					<li class="">
						<div class="form-control template-icon">
							آیکون قالب
							<div>
								<vt-photo ng-model="Data.userDefinedTemplateThumnail" ratio="1"
									style="position: absolute; left: 42px; top: 60px;" is-edit-mode="Data.mode!='view'"
									no-title-description="true" template-mode="true">
								</vt-photo>
							</div>
						</div>
					</li>
					<!--<li>-->
					<!--<button-->
					<!--style="margin-top: 1px;"-->
					<!--class="btn btn-xs btn-primary col-sm-12"-->
					<!--ng-disabled="!Data.userDefinedTemplateName"-->
					<!--ng-click="Func.savePrivateLetterTemplate();"-->
					<!--access-checker="API_ADD_PRIVATE_LETTER_TEMPLATE">ذخیره قالب</button>-->
					<!--</li>-->
					<li>
						<buttom
								style="margin-top: 10px; padding-top: 10px; border-radius: 2px; "
								class="btn btn-xs btn-primary col-sm-12"
								ng-disabled="!Data.userDefinedTemplateName"
								ng-click="Func.savePublicLetterTemplate();"
								access-checker="API_ADD_PUBLIC_LETTER_TEMPLATE">ذخیره قالب</buttom>
					</li>
				</ul>
			</div>
		</div>
	</div>
</div>
<div class="panel panel-primary">
	<div class="panel-body">
		<ul class="nav nav-tabs" style="position: sticky;top: 0px;background: #fff;z-index: 23;">
			<li role="presentation" ng-class="{'active':tab.active}"
				ng-repeat="tab in Data.tabList"
				ng-click="Func.onTabClick(tab)"><a>{{tab.title}}</a></li>
		</ul>

		<form name="form" novalidate>
			<div class="col-sm-9" ng-show="Data.selectedTab.id == 0">
               	<letter-form-type ng-model="Data.selectedLetterFormType" ng-if="(Data.mode==='view' && Data.letter && Data.letter.forms && Data.letter.forms.length>0) || Data.mode!=='view'"
                   	apis="Apis" mode="Data.mode" letter="Data.letter" org-uid="Data.orgUid"></letter-form-type>
            </div>
			<div class="col-sm-12 " ng-show="Data.selectedTab.id == 0">
                <div class="c1">
                    <div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.externalNumber.$invalid}">
                        <label class="col-sm-12 text-danger" ng-show="Data.letter.duplicated==true">این نامه قبلا ثبت شده است</label>
                        <label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">شماره خارجی</label>
                        <div ng-show="Data.mode=='view'" class="col-sm-8">
                    {{Data.letter.externalNumber|EnToFaNumber}}
                        </div>
                        <div ng-show="Data.mode!='view'" class="col-sm-8">
                            <input ng-blur="Func.searchLetterByExternalnumber(Data.letter.externalNumber)" type="text" class="form-control" name="externalNumber"
                                ng-model="Data.letter.externalNumber" ng-change="Data.duplicateList=[]" required>
                            <div ng-show="Data.duplicateList.length" class="duplicate-letter">
                                <div class="header">نامه‌های مشابه</div>
                                <span class="kateb-label kateb-label--default-light  fa-btn"
                                    ng-repeat="item in Data.duplicateList"
                                    ng-click="Func.onDuplicateClick(item)">{{item.title}}</span>
                            </div>
                        </div>
                    </div>
                    <div class="row rowForm">
                     <label class="col-xs-4">رده موضوعی</label>
                     <div ng-show="Data.mode=='view'" class="col-sm-8">
                {{Data.letter.topicCategory.title}}
                     </div>
					<div ng-show="Data.mode!='view'" class="col-sm-8 dropdown-selector">
                        <i class="fa fa-times" ng-click="Func.onRemoveSenderClick('topicCategory')" ng-show="Data.topicCategory"></i>
						<ui-select name="topicCategory" ng-model="Data.topicCategory"
								   on-select="Func.onSelectTopicCategory($item, $model)">
							<ui-select-match>
								<span ng-bind="$select.selected.title"></span>
							</ui-select-match>
							<ui-select-choices
                                    repeat="item in (Data.tagList | filter: $select.search) track by $index"
                                    refresh="Func.searchTagList($select.search)"
                                    refresh-delay="0">
								<span ng-bind="item.title"></span>
							</ui-select-choices>
						</ui-select>
					</div>
                </div>

				<div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.subject.$invalid}">
					<label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">موضوع</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">
				{{Data.letter.subject|EnToFaNumber}}
					</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<input type="text" class="form-control auto-size-input" name="subject"
							ng-model="Data.letter.subject" required ng-init="doAoutoSizeInput()" maxlength="250"/>
							<div id="counter"></div>
							<span id="hidden_span"></span>
					</div>
				</div>

				<div class="row rowForm">
					<label class="col-xs-4">برچسب‌ها</label>
					<div class="col-sm-8">
						<!--<multiselect model="Data.letter.tags" options="Data.tagList"-->
							<!--is-edit-mode="Data.mode!='view'"></multiselect>-->
                        <multiselect-reciever model="Data.letter.tags" search-fn="controller.multiselectRecieverSearchTags(query)"
                                              name="letterTags" ng-model="Data.letter.tags"
                                              is-edit-mode="Data.mode!='view'"></multiselect-reciever>
					</div>
				</div>
				<div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.officialData.$invalid}">
					<label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">تاریخ اولیه مدرک</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">
				{{Data.letter.officialDate|tehranDate:'jDD-jMMMM-jYYYY'|EnToFaNumber}}
					</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<vt-persian-date-picker name="officialData" max-date="Data.officialMaxDate"
							model="Data.letter.officialDate"></vt-persian-date-picker>
					</div>
				</div>
				<div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.originalityType.$invalid}">
					<label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">نوع مدرک</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">
				{{Data.letter.originalityType|appEnum:licenceType}}
					</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<select class="form-control" ng-model="Data.letter.originalityType" name="originalityType" required>
							<option value="Copy">کپی</option>
							<option value="Orginal">اصل</option>
							<option value="CopyAsOrginal">کپی برابر با اصل</option>
						</select>
					</div>
				</div>
				<div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.receivingStyle.$invalid}">
					<label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">نوع دریافت</label>
					<div ng-show="Data.mode=='view' || Data.letter.receivingStyle=='KATEB' || Data.letter.receivingStyle=='ECEP'" class="col-sm-8">
				{{Data.letter.receivingStyle|appEnum:letterRecivingType}}
					</div>
					<div ng-show="Data.mode!='view' && Data.letter.receivingStyle!='KATEB' && Data.letter.receivingStyle!='ECEP'" class="col-sm-8">
						<select class="form-control" ng-model="Data.letter.receivingStyle" name="receivingStyle">
							<option value="POST">پست</option>
							<option value="FAX">فکس</option>
							<option value="COURIER">پیک</option>
						</select>
					</div>
				</div>
				<div class="row rowForm" ng-hide="Data.mode=='view' && !Data.letter.confidentialityLevel">
					<label class="col-xs-4">اندازه صفحه</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">{{Data.letter.pageSize}}</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<select class="form-control" ng-model="Data.letter.pageSize" name="draftPageSize">
							<option value="A4">A4</option>
							<option value="A5">A5</option>
							<option value="B5">B5</option>
						</select>
					</div>
				</div>
				<div class="row rowForm">
					<label class="col-xs-4">فوریت</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">{{Data.letter.priority|appEnum:priority}}</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<select class="form-control" ng-model="Data.letter.priority">
							<option value="Normal">عادی</option>
							<option value="Critical">فوری</option>
							<option value="Blocker">خیلی فوری</option>
						</select>
					</div>
				</div>
				<div class="row rowForm">
					<label class="col-xs-4">سطح محرمانگی</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">{{Data.letter.confidentialityLevel|appEnum:confidentialityLevel}}</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<select class="form-control" ng-model="Data.letter.confidentialityLevel">
							<option value="Unclassified">طبقه بندی نشده</option>
							<option value="Restricted">محرمانه</option>
							<option value="Confidential">فوق محرمانه</option>
							<option value="Secret">سری</option>
							<option value="Top_secret">فوق سری</option>
						</select>
					</div>
				</div>
				<div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.indicatorBook.$invalid}">
					<label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">دفتر اندیکاتور</label>
					<div ng-show="Data.mode=='view'" class="col-sm-8">
				{{Data.letter.indicatorBook.title|EnToFaNumber}}
					</div>
					<div ng-show="Data.mode!='view'" class="col-sm-8">
						<select class="form-control" ng-model="Data.indicatorBook" name="indicatorBook" required
							ng-change="Func.onSelectIndicatorBook(Data.indicatorBook)"
							ng-options="indicatorBook as indicatorBook.title for indicatorBook in Data.indicatorBookList">
						</select>
					</div>
				</div>
				
                </div>
                <div class="c2">
                    <div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.letterDeliveryTo.$invalid}">
                        <label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">گیرندگان</label>
                        <div class="col-sm-8">
                            <multiselect-reciever model="Data.letter.deliveryTo" search-fn="controller.multiselectRecieverSearch(query)"
                                name="letterDeliveryTo" ng-model="Data.letter.deliveryTo" vt-array-required
                                is-edit-mode="Data.mode!='view'"></multiselect-reciever>
                        </div>
                    </div>
                    <div class="row rowForm">
                        <label class="col-xs-4">رونوشت</label>
                        <div class="col-sm-8">
                            <multiselect-reciever has-description="true" model="Data.letter.deliveryCc" search-fn="controller.multiselectRecieverSearch(query)"
                                is-edit-mode="Data.mode!='view'"></multiselect-reciever>
                        </div>
                        <div ng-show="Data.mode!='view'" class="col-xs-4">
                            <a ng-init="bcc=false" ng-click="bcc = !bcc" ng-show="!bcc" class="text-success">افزودن رونوشت پنهان</a>
                        </div>
                    </div>
                    <div class="row rowForm" ng-show="bcc || Data.letter.deliveryBcc.length">
                        <label class="col-xs-4">رونوشت پنهان</label>
                        <div class="col-sm-8">
                            <multiselect-reciever has-description="true" model="Data.letter.deliveryBcc" search-fn="controller.multiselectRecieverSearch(query)"
                                is-edit-mode="Data.mode!='view'"></multiselect-reciever>
                        </div>
                    </div>
    <!-- 				<div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.externalOrganizationSender.$invalid}"> -->
                    <div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.externalOrganizationSender.$invalid}">
                        <label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">سازمان فرستنده</label>
                        <div ng-show="Data.mode=='view' || Data.letter.receivingStyle=='KATEB'" class="col-sm-8">{{Data.letter.externalOrganizationSender.title}}</div>
                        <div ng-show="Data.mode!='view' && Data.letter.receivingStyle!='KATEB'" class="col-sm-8">
                            <ui-select name="externalOrganizationSender" ng-model="Data.letter.externalOrganizationSender" required
                                on-select="Func.onSelectOrganizationSender($item, $model)">
                                <ui-select-match>
                                    <span ng-bind="$select.selected.title"></span>
                                </ui-select-match>
                                <ui-select-choices repeat="item in (Data.organizationSenderList | filter: $select.search) track by $index">
                                    <span ng-bind="item.title"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="row rowForm" ng-class="{'has-error':Data.validationClicked && form.letterSender.$invalid}">
                        <label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">فرستنده</label>
                        <div ng-show="Data.mode=='view'" class="col-sm-8">
                    {{Data.letter.sender.title}}
                        </div>
                        <div ng-show="Data.mode!='view'" class="col-sm-8">
                            <ui-select required
                                  name="letterSender"
                                   on-select="Func.onSelectSender($item, $model)"
                                   reset-search-input="false"
                                ng-model="Data.letter.sender">
                                <ui-select-match allow-clear="true">
                                    <span ng-bind="$select.selected.title"></span>
                                </ui-select-match>
                                <ui-select-choices
                                        refresh="Func.getUiSelectData($select)"
                                        refresh-delay="0"
                                        repeat="item in (Data.senderList | filter: $select.search) track by $index">
                                    <span ng-bind="item.title"></span>
                                </ui-select-choices>
                            </ui-select>
                        </div>
                    </div>
                    <div class="row rowForm" ng-show="Data.mode!='view'">
                        <label class="col-xs-4">نیاز به پاسخ</label>
                        <div class="col-sm-8">
                            <input type="checkbox" ng-model="Data.responseNeeded">
                        </div>
                    </div>
                    <div class="row rowForm" ng-if="Data.responseNeeded">
                        <label class="col-xs-4">مهلت پاسخ</label>
                        <div ng-show="Data.mode=='view'" class="col-sm-8">
                    {{Data.letter.requestResponseDate|tehranDate:'jDD-jMMMM-jYYYY'|EnToFaNumber}}
                        </div>
                        <div ng-show="Data.mode!='view'" class="col-sm-7">
                            <vt-persian-date-picker name="requestResponseDate" min-date="Data.currentDate" model="Data.letter.requestResponseDate"></vt-persian-date-picker>
                        </div>
                    </div>
                    <div class="row rowForm">
                        <label class="col-xs-4">توضیحات</label>
                        <div ng-show="Data.mode=='view'" class="col-sm-8">
                    {{Data.letter.description|EnToFaNumber}}
                        </div>
                        <div ng-show="Data.mode!='view'" class="col-sm-8">
                            <textarea type="text" class="form-control" name="description"
                                ng-model="Data.letter.description"></textarea>
                        </div>
                    </div>
                    <div ng-if="Data.hasExternalArchives" class="row rowForm" ng-class="{'has-error':Data.validationClicked && Data.vtFolderSelectorForm.$invalid}">
                        <label class="col-xs-4" ng-class="{'required':Data.mode!='view'}">بایگانی نامه</label>
                        <div class="col-sm-8">
                            <ng-form name="Data.vtFolderSelectorForm">
                                <vt-folder-selector model="Data.letter.externalArchive" form-name="Data.vtFolderSelectorForm" required = "Data.mode=='add'"
                                                    is-edit-mode="Data.mode!='view'" modernization-code-placement="'right'"></vt-folder-selector>
                            </ng-form>
                        </div>
                    </div>
                    
                    
                    
<!--                    c2-->
                </div>
				
				
                
			</div>

			<div class="col-sm-12" ng-show="Data.selectedTab.id == 1">
                <div class="rowForm col-sm-12" ng-class="{'has-error':Data.validationClicked && form.letterBody.$invalid}">
                    <letter-body model="Data.letter.body" ng-required="!Data.scanedFile.hash" name="letterBody" ng-model="Data.letter.body"
                    			is-edit-mode="Data.mode!='view'" api="controller.letterBody"
                    			on-file-uploaded="loadPdfFn" pdf-url="Data.scanedFile">
                    </letter-body>
                </div>
                <div class="rowForm col-sm-12" ng-show="Data.mode!='view'">
                    <scanner  options="controller.scanner.options"   isolate-form model="Data.scanedFile" api="controller.scanner" ></scanner>
					<!-- <div ng-if="controller.vtPDF.pdfUrl" style="height: calc(100vh - 240px)" vt-pdf control-fn="controller.vtPDF"></div> -->
                </div>
			</div>

			<div class="col-sm-12" ng-show="Data.selectedTab.id == 2">
				<letter-attachment

                    model="Data.letter.attachments"
                    is-edit-mode="Data.mode!='view'">
                </letter-attachment>
			</div>
		</form>
	<div>
</div>
